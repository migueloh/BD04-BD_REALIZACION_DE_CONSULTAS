DROP TABLE EMPLEADOS CASCADE CONSTRAINTS;
DROP TABLE HISTORIAL_LABORAL CASCADE CONSTRAINTS;

CREATE TABLE EMPLEADOS(
EMP_NO		VARCHAR(6) 	 CONSTRAINT EM_PK PRIMARY KEY,
NOMBRE		VARCHAR2(10) NOT NULL,
APELLIDO1	VARCHAR2(15) NOT NULL,
APELLIDO2 	VARCHAR2(15) NOT NULL,
DIRECC		VARCHAR2(25),
CIUDAD 		VARCHAR2(20),
MUNICIPIO	VARCHAR2(20),
COD_POSTAL	VARCHAR2(5),
SEXO		CHAR CONSTRAINT EM_SEX_CK CHECK(SEXO IN('H','M')),
FECHA_NAC	DATE,
TRAB_COD 	VARCHAR2(3),
SALARIO		NUMBER(8,2),
DIR			VARCHAR2(6) REFERENCES EMPLEADOS ON DELETE SET NULL,
DPTO_COD	NUMBER(5));

CREATE TABLE HISTORIAL_LABORAL(
EMP_NO 			VARCHAR(6) CONSTRAINT HL_DNI_FK REFERENCES EMPLEADOS
						  ON DELETE CASCADE,
TRAB_COD		VARCHAR2(3) ,
FECHA_INICIO	DATE,
FECHA_FIN		DATE,
DPTO_COD		NUMBER(5),
CONSTRAINT HL_PK PRIMARY KEY(EMP_NO,FECHA_INICIO),
CONSTRAINT HL_FECHAS CHECK(FECHA_INICIO<FECHA_FIN));

INSERT INTO EMPLEADOS VALUES('1111','PEPE','GOMEZ','ARROYO',NULL,NULL,NULL,NULL,'H','20/09/45','T2',3400,NULL,10);
INSERT INTO EMPLEADOS VALUES('2222','ANA','GONZALEZ','LOPEZ','DATO,5','VITORIA',NULL,'01013','H','20/09/45','T1',1200,'1111',20);
INSERT INTO EMPLEADOS VALUES('3333','LUIS','NEGRO','RUIZ','POSTAS,23','VITORIA',NULL,'01014','H','20/09/45','T3',2500,'1111',10);
INSERT INTO EMPLEADOS VALUES('4444','ROSA','REY','JIMENEZ',NULL,NULL,NULL,NULL,'H','20/09/45','T3',2200,'2222',30);

INSERT INTO HISTORIAL_LABORAL VALUES('1111','T1','10/01/79','15/06/87',10);
INSERT INTO HISTORIAL_LABORAL VALUES('1111','T2','18/01/88','15/06/95',20);
INSERT INTO HISTORIAL_LABORAL VALUES('1111','T1','17/06/96','21/07/98',10);
INSERT INTO HISTORIAL_LABORAL VALUES('2222','T1','10/01/99','15/06/00',10);
INSERT INTO HISTORIAL_LABORAL VALUES('2222','T5','10/01/02','20/03/05',10);
INSERT INTO HISTORIAL_LABORAL VALUES('3333','T2','10/01/08','15/06/10',30);
INSERT INTO HISTORIAL_LABORAL VALUES('3333','T5','10/01/05','15/06/07',20);
INSERT INTO HISTORIAL_LABORAL VALUES('4444','T3','10/01/11','28/01/11',10);


COMMIT;